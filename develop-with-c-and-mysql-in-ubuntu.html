<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Ubuntu下的mysql和C语言开发 - 尚弟的小笔记</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="尚弟" /><meta name="description" content="一. 开发环境的准备 #####1. 首先要安装好Linux，这里用的是Ubuntu 10.10 #####2. 安装MySQL系列软件包一、开发环境的准备 #####3. 首先要安装好Linux，这" /><meta name="keywords" content="尚弟, 博客, 笔记" />






<meta name="generator" content="Hugo 0.89.4 with theme even" />


<link rel="canonical" href="https://blog.shrp.me/develop-with-c-and-mysql-in-ubuntu.html" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Ubuntu下的mysql和C语言开发" />
<meta property="og:description" content="一. 开发环境的准备 #####1. 首先要安装好Linux，这里用的是Ubuntu 10.10 #####2. 安装MySQL系列软件包一、开发环境的准备 #####3. 首先要安装好Linux，这" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.shrp.me/develop-with-c-and-mysql-in-ubuntu.html" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2011-02-25T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-06-12T15:13:29+08:00" />

<meta itemprop="name" content="Ubuntu下的mysql和C语言开发">
<meta itemprop="description" content="一. 开发环境的准备 #####1. 首先要安装好Linux，这里用的是Ubuntu 10.10 #####2. 安装MySQL系列软件包一、开发环境的准备 #####3. 首先要安装好Linux，这"><meta itemprop="datePublished" content="2011-02-25T00:00:00+00:00" />
<meta itemprop="dateModified" content="2021-06-12T15:13:29+08:00" />
<meta itemprop="wordCount" content="4084">
<meta itemprop="keywords" content="Ubuntu,MySQL,C," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Ubuntu下的mysql和C语言开发"/>
<meta name="twitter:description" content="一. 开发环境的准备 #####1. 首先要安装好Linux，这里用的是Ubuntu 10.10 #####2. 安装MySQL系列软件包一、开发环境的准备 #####3. 首先要安装好Linux，这"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">尚弟的小笔记</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">首页</li>
      </a><a href="/tags.html">
        <li class="mobile-menu-item">标签</li>
      </a><a href="/post.html">
        <li class="mobile-menu-item">归档</li>
      </a><a href="/rss.xml">
        <li class="mobile-menu-item">RSS</li>
      </a><a href="/blogrolls.html">
        <li class="mobile-menu-item">友情链接</li>
      </a><a href="/about.html">
        <li class="mobile-menu-item">关于我</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">尚弟的小笔记</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">首页</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags.html">标签</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post.html">归档</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/rss.xml">RSS</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/blogrolls.html">友情链接</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about.html">关于我</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Ubuntu下的mysql和C语言开发</h1>

      <div class="post-meta">
        <span class="post-time"> 2011-02-25 </span>
        
          <span class="more-meta"> 约 4084 字 </span>
          <span class="more-meta"> 预计阅读 9 分钟 </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li>
          <ul>
            <li><a href="#一-开发环境的准备">一. 开发环境的准备</a></li>
            <li><a href="#二-检查mysql服务的状态">二. 检查MySQL服务的状态</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
  <div class="post-outdated">
    <div class="warn">
      <p>【注意】最后更新于 <span class="timeago" datetime="2021-06-12T15:13:29" title="June 12, 2021">June 12, 2021</span>，文中内容可能已过时，请谨慎使用。</p>
    </div>
  </div>
    <div class="post-content">
      <h3 id="一-开发环境的准备">一. 开发环境的准备</h3>
<p>#####1. 首先要安装好Linux，这里用的是Ubuntu 10.10
#####2. 安装MySQL系列软件包一、开发环境的准备
#####3. 首先要安装好Linux，这里用的是Ubuntu 10.10
#####4. 安装MySQL系列软件包，这边10.10系统仓库里面的是MySQL5.1版本：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">sudo apt-get install mysql-server
sudo apt-get install mysql-client
sudo apt-get install libmysqlclient15-dev
</code></pre></td></tr></table>
</div>
</div><h3 id="二-检查mysql服务的状态">二. 检查MySQL服务的状态</h3>
<h5 id="1-查看当前的mysql服务状态">1. 查看当前的mysql服务状态</h5>
<p><code>sudo /etc/init.d/mysql status</code></p>
<h5 id="2-也可以用以下检查mysql服务是否有启动如果结果为空则没有启动">2. 也可以用以下检查mysql服务是否有启动，如果结果为空，则没有启动</h5>
<p><code>sudo netstat -tap | grep mysql </code>或<code>ps -ef | grep mysql</code>
###三. 启动/停止/重启MySQL服务
#####1. 启动：<code>sudo /etc/init.d/mysql start</code>
#####2. 停止：<code>sudo /etc/init.d/mysql stop</code>
#####3. 重启：<code>sudo /etc/init.d/mysql restart</code>
###四. 在命令行使用MySQL客户端访问数据库
#####1. 访问本地主机：
<code>mysql -uuser -ppassword db_name</code>
#####2. 访问远程主机：
<code>mysql -hhost -uuser -ppassword db_name</code>
备注：由于默认的配置是只能从本机访问，只要注释掉/etc/mysql/my.cnf里面的bind-address这行，就可以让远程主机访问了。
#####3、执行管理操作：
使用mysqladmin及相关参数
#####4、备份 db_name 数据库：
<code>mysqldump -uroot -p --default-character-set=utf8 --opt     --extended-insert=false --triggers -R --hex-blob -x db_name &gt; bak.sql</code>
#####5、恢复db_name数据库：
<code>mysql -uroot -p db_name &lt; bak.sql</code>
#####6、备份tbl_name 数据表：
<code>select * into outfile '/usr/local/mysql/f.txt' fields terminated by '|' from tbl_name;</code>
#####7、把文件/home/a.txt导入数据库中的 tbl_name表
<code>mysql&gt; load data local infile '/home/a.txt'  into table tbl_name fields terminated by ',' lines terminated by '\r\n';</code>
#####8、设置mysql数据库root的初始密码</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">shell&gt; mysql -u root
mysql&gt; SET PASSWORD FOR &#39;&#39;@&#39;localhost&#39; = PASSWORD(&#39;newpwd&#39;);
mysql&gt; SET PASSWORD FOR &#39;&#39;@&#39;host_name&#39; = PASSWORD(&#39;newpwd&#39;);
</code></pre></td></tr></table>
</div>
</div><p>#####9、为普通用户修改密码：
<code>mysql&gt; SET PASSWORD FOR 'user_name'@'host_name' = PASSWORD('newpwd');</code>
#####10、建立超级用户账户，具有完全的权限可以做任何事情：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">mysql&gt; GRANT ALL PRIVILEGES ON *.* TO &#39;monty&#39;@&#39;localhost&#39;
-&gt;     IDENTIFIED BY &#39;some_pass&#39; WITH GRANT OPTION;
mysql&gt; GRANT ALL PRIVILEGES ON *.* TO &#39;monty&#39;@&#39;%&#39;
-&gt;     IDENTIFIED BY &#39;some_pass&#39; WITH GRANT OPTION;
</code></pre></td></tr></table>
</div>
</div><p>备注：第一句建立用于本机连接的帐户，第二句建立用于从其他主机连接的帐户。
#####11、建立帐户custom，可以访问bankaccount数据库，但只能从本机访问</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">mysql&gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP
-&gt;     ON bankaccount.*
-&gt;     TO &#39;custom&#39;@&#39;localhost&#39;
-&gt;     IDENTIFIED BY &#39;obscure&#39;;
</code></pre></td></tr></table>
</div>
</div><p>###五、Linux下C开发MySQL数据库应用程序的简要流程
编译：<code>gcc -o bin_name hello.c -I /usr/include/mysql -L /usr/lib/mysql -lmysqlclient -lz -lm</code>
#####1、定义MYSQL变量
<code>MYSQL mysql;</code>
#####2、初始化MYSQL变量
<code>mysql_init(&amp;mysql);</code>
#####3、连接到MySQL数据库
<code>mysql_real_connect(&amp;mysql,”hostname”,”username”,”password”,”database”,0,NULL,0);</code>
#####4、指定本连接的字符集（可选，www.linuxidc.com主要为了确认客户端与服务器之间使用一致的字符集进行通信）
<code>mysql_query( &amp;mysql , &quot;SET NAMES 'utf8'&quot;);</code>
#####5、执行SQL语句
<code>mysql_real_query( &amp;mysql, SQL, SQL_LEN ) ;</code>
#####6、获取查询结果</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">MYSQL_RES *result;
result = mysql_store_result( &amp;mysql ) ;
row_count = ( int )mysql_num_rows( result ) ;
field_count = ( int )mysql_num_fields( result ) ;
</code></pre></td></tr></table>
</div>
</div><p>#####7、循环调用mysql_fetch_row ，以便获取查询结果的每一行</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">MYSQL_ROW row;
row = mysql_fetch_row( result ) ;//下一次再调用便自动指向result的下一行
printf(“%s\n”,row[index]);//注意转换各个字段的类型
</code></pre></td></tr></table>
</div>
</div><p>#####8、释放资源</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">mysql_free_result( result ) ;
</code></pre></td></tr></table>
</div>
</div><p>#####9、关闭MYSQL连接</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">mysql_close(&amp;mysql);
</code></pre></td></tr></table>
</div>
</div><p>###六、一个简单的例子</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">//打印出本地主机的pim数据库里面的classmate数据表的第一、第二列。用户名kitty，密码a1。
//编译：gcc -o bin_name hello.c -I /usr/include/mysql -L /usr/lib/mysql -lmysqlclient -lz -lm

#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;mysql.h&gt;

int main( int argc , char* argv[] )
{
	MYSQL mysql;
	//连接mysql
	if(connect_mysql(&amp;mysql))
	{
	return 1;
	}
	//载入数据
	if( load_classmate(&amp;mysql) )
	{
	mysql_close(&amp;mysql);
	return 1;
	}
	//Do something here.
	//关闭mysql
	mysql_close(&amp;mysql);
	return 0;
	}
	//连接MYSQL数据库
	int connect_mysql(MYSQL* mysql)
	{
		printf( &#34;Initializing mysql.................&#34; );
		if ( !mysql_init(mysql) )
		{
			return 1;
		}
		printf( &#34;Done\r\n&#34; );
		printf( &#34;Connectiong to mysql...............&#34; );
		if (!mysql_real_connect(mysql,&#34;localhost&#34;,&#34;kitty&#34;,&#34;a1&#34;,&#34;pim&#34;,0,NULL,0))
		{
			fprintf(stderr, &#34;Error: %s\r\n&#34;, mysql_error(mysql));
			return 1;
		}
		//设置mysql连接的字符集
		mysql_query( mysql, &#34;SET NAMES &#39;utf8&#39;&#34; );
		printf( &#34;Done\r\n&#34; );
		return 0;
	}
	//加载数据表
	int load_classmate(MYSQL *mysql)
	{
		int ret,field_count,row_count,i;
		int *lengths;
		char *query=&#34;select * from classmate&#34;;
		MYSQL_RES *result;
		MYSQL_ROW row;
		ret = mysql_real_query( mysql, query, strlen(query) ) ;
		if(ret != 0)
		{
		printf(&#34;加载不了classmate的数据。\n&#34;);
		return 1;
	}
	result = mysql_store_result( mysql ) ;
	row_count = ( int )mysql_num_rows( result ) ;
	field_count = ( int )mysql_num_fields( result ) ;
	if( result == NULL &amp;&amp; field_count == 0 )
	{
		printf(&#34;查询不到数据。&#34;);
		return 1;
	}
	for( i = 0 ; i &lt; row_count ; i++ )
	{
		row = mysql_fetch_row( result ) ;
		printf( &#34;%2d | %8s \r\n&#34;, atoi( row[ 0 ] ), row [ 1 ] ) ;
	}
	mysql_free_result( result ) ;
	return 0;
}
</code></pre></td></tr></table>
</div>
</div><p>###七、MySQL数据库中文乱码的解决办法
MySQL的字符集和校对规则有4个级别的默认设置：服务器级、数据库级、表级和连接级。我们解决中文乱码的方法就顺着这几个级别来分别设置。比较常见的是由于没有设置连接级的字符集导致的乱码。
#####1、服务器级字符集
服务器级也就是当服务器启动时根据配置文件中的字符集来加载。当前的服务器字符集和校对规则可以用作character_set_server和collation_server系统变量的值。在运行时能够改变这些变量的值。针对服务器级，我们有两个方法可以解决。
######a、重新编译MySQL
更改设定值的一个方法是通过重新编译。如果希望在从源程序构建时更改默认服务器字符集和校对规则，使用：&ndash;with-charset和&ndash;with-collation作为configure的参量。例如：
<code>shell&gt; ./configure --with-charset=utf8</code>
######b、不重新编译，只修改当前配置文件
打开/etc/mysql/my.cnf修改编码：
在[mysqld]下添加：<code>default-character-set=utf8</code>
在[client]下添加：<code>default-character-set=utf8</code>
在[mysql]下添加：<code>default-character-set=utf8</code>
然后重启mysql应该就可以了！
#####2、数据库级字符集
默认数据库的字符集和校对规则可以用作character_set_database和 collation_database系统变量。无论何时默认数据库更改了，服务器都设置这两个变量的值。如果没有 默认数据库，这两个变量与相应的服务器级别的变量（character_set_server和collation_server）具有相同的值。
######a、重新建数据库，并指定默认字符集
数据库级是在新建数据库时指定该数据库默认的字符集。
<code>mysql&gt;create database db_name character set charset_name ;</code></p>
<p>比如：
<code>mysql&gt;create database db_name character set utf8 ;</code>
######b、不重新建数据库，通过alter database来修改数据库的默认字符集
如果之前在建表的时候没有指定character set charset_name，也可以通过以下重新指定：     <code>mysql&gt;alter database db_name character set charset_name ;</code></p>
<p>比如：
<code>mysql&gt;alter database db_name character set utf8 ;</code>
#####3、表级字符集
如果在表定义中没有指定表字符集和校对规则，则默认使用数据库字符集和校对规则。
######a、重新建表，并指定默认字符集
表级字符集是在建立表的时候指定该表的默认字符集。
<code>mysql&gt;create table tbl_name (column_list) default character set charset_name ;</code>
######b、不重新建表，通过alter table来修改表的默认字符集
如果之前在建表的时候没有指定character set charset_name，也可以通过以下重新指定：  <br>
<code>mysql&gt;alter table tbl_name default character set charset_name ;</code>
备注：列级别的字符集和表级别字符集的规则类似，也可以在建表的语句里面指定，若没有指定则默认使用表级别的字符集，若表也没有指定默认字符集，则往上推。
#####4、连接级字符集
从以下几个方面来理解连接级字符集：（类似一种网络协议，服务器、客户端之间预先设置的通信规则）
######a、当查询离开客户端后，在查询中使用哪种字符集？
服务器使用character_set_client变量作为客户端发送的查询中使用的字符集。
######b、服务器接收到查询后应该转换为哪种字符集？
转换时，服务器使用character_set_connection和collation_connection系统变量。它将客户端发送的查询从character_set_client系统变量转换到character_set_connection（除非字符串文字具有象_latin1或_utf8的引介词）。collation_connection对比较文字字符串是重要的。对于列值的字符串比较，它不重要，因为列具有更高的校对规则优先级。
######c、服务器发送结果集或返回错误信息到客户端之前应该转换为哪种字符集？
character_set_results变量指示服务器返回查询结果到客户端使用的字符集。包括结果数据，例如列值和结果元数据（如列名）。
我们能够调整这些变量的设置，有两个语句影响连接字符集：
<code>SET NAMES 'charset_name'</code>
<code>SET CHARACTER SET charset_name</code></p>
<p>SET NAMES显示客户端发送的SQL语句中使用什么字符集。因此，SET NAMES &lsquo;cp1251&rsquo;语句告诉服务器“将来从这个客户端传来的信息采用字符集cp1251”。它还为服务器发送回客户端的结果指定了字符集。（例如，如果你使用一个SELECT语句，它表示列值使用了什么字符集。）
SET NAMES &lsquo;x&rsquo;语句与这三个语句等价：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">mysql&gt; SET character_set_client = x;
mysql&gt; SET character_set_results = x;
mysql&gt; SET character_set_connection = x;
</code></pre></td></tr></table>
</div>
</div><p>要设置连接级的字符集，可以在编写MySQL数据库应用程序时，在客户端程序发
起连接到服务器后，执行一条语句，如下情形：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">mysql_real_connect(&amp;mysql,”hostname”,”username”,”password”,”database”,0,NULL,0);
mysql_query( &amp;mysql , &#34;SET NAMES &#39;utf8&#39;&#34;);
</code></pre></td></tr></table>
</div>
</div><p>这样便可指定本次连接使用的默认字符集为utf8了。
###八、一些MYSQL常用的命令
#####1.列出MYSQL支持的所有字符集：
<code>SHOW CHARACTER SET;</code>
#####2.当前MYSQL服务器字符集设置
<code>SHOW VARIABLES LIKE 'character_set_%';</code>
#####3.当前MYSQL服务器字符集校验设置
<code>SHOW VARIABLES LIKE 'collation_%';</code>
#####4.显示某数据库字符集设置
<code>show create database 数据库名;</code>
#####5.显示某数据表字符集设置
<code>show create table 表名;</code>
#####6.修改数据库字符集
<code>alter database 数据库名 default character set 'utf8';</code>
#####7.修改数据表字符集
<code>alter table 表名 default character set 'utf8';</code>
#####8.建库时指定字符集
<code>create database 数据库名 character set gbk collate gbk_chinese_ci;</code>
#####9.建表时指定字符集
<code>CREATE TABLE `mysqlcode` ( `id` TINYINT( 255 ) UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY , `content` VARCHAR( 255 ) NOT NULL ) TYPE = MYISAM CHARACTER SET gbk COLLATE gbk_chinese_ci;</code>
###九、参考
MySQL 5.1 官方简体中文版参考手册</p>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">尚弟</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
        2021-06-12
        <a href="https://github.com/stirp/stirp.github.io/commit/7e4096a4b0a9fcb6c66839c35464229ff717d2fe" title="update imported">(7e4096a)</a>
    </span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">许可协议</span>
    <span class="item-content">© Copyright 2021 by 尚弟</span>
  </p>
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/Ubuntu.html">Ubuntu</a>
          <a href="/tags/MySQL.html">MySQL</a>
          <a href="/tags/C.html">C</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/my-next-goal.html">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">自己的下一个目标</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        <a class="next" href="/virtual-machine-port-pass-through.html">
            <span class="next-text nav-default">通过母机将虚拟机的端口穿透出去</span>
            <span class="next-text nav-mobile">下一篇</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        <div id="disqus_thread"></div>
    <script type="text/javascript">
    (function() {
      
      
      if (window.location.hostname === 'localhost') return;

      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      var disqus_shortname = 'stirp';
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:srpwy@163.com" class="iconfont icon-email" title="email"></a>
      <a href="https://github.com/stirp" class="iconfont icon-github" title="github"></a>
  <a href="https://blog.shrp.me/rss.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://gohugo.io">Hugo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2010 - 
    2023<span class="heart"><i class="iconfont icon-heart"></i></span><span>shrp</span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/timeago.js@3.0.2/dist/timeago.min.js" integrity="sha256-jwCP0NAdCBloaIWTWHmW4i3snUNMHUNO+jr9rYd2iOI=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/timeago.js@3.0.2/dist/timeago.locales.min.js" integrity="sha256-ZwofwC1Lf/faQCzN7nZtfijVV6hSwxjQMwXL4gn9qU8=" crossorigin="anonymous"></script>
  <script><!-- NOTE: timeago.js uses the language code format like "zh_CN" (underscore and case sensitive) -->
    var languageCode = "zh-cn".replace(/-/g, '_').replace(/_(.*)/, function ($0, $1) {return $0.replace($1, $1.toUpperCase());});
    timeago().render(document.querySelectorAll('.timeago'), languageCode);
    timeago.cancel();  
  </script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>

<script id="baidu_analytics">
  var _hmt = _hmt || [];
  (function() {
    if (window.location.hostname === 'localhost') return;
    var hm = document.createElement("script"); hm.async = true;
    hm.src = "https://hm.baidu.com/hm.js?249d9fe60c26e4771c81467fa3b43862";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
</script>






</body>
</html>
